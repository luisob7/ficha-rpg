<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Ficha do Jogador</title>
<style>
  *, *::before, *::after { box-sizing: border-box; }
  html, body { height:100%; margin:0; padding:0; font-family: Arial,sans-serif; background: linear-gradient(#05030e,#171433,#332d73,#6435a9); color:#f0f0f0; display:flex; justify-content:center; align-items:center; overflow:hidden; }
  .container { width:95%; min-width:85%; max-width:1200px; max-height:90vh; background:#ffd285; border:12px solid; border-image: linear-gradient(to right,#411013,#5b1c0b,#823815,#933d00,#a4510b,#803900,#ae4f00,#d26e10,#da7b21,#d37c37,#762f03) 1; border-radius:15px; display:flex; flex-direction:column; overflow:hidden; }
  .content { flex:1; overflow-y:auto; padding:1rem 0; }
  .block { padding:1.5rem 2rem; display:flex; flex-direction:column; gap:1rem; }
  .divider { height:3px; background-color:#d68f54; width:100%; margin:0; }
  .block-1 { flex-direction:row; align-items:flex-start; gap:2rem; flex-wrap:wrap; }
  .profile-pic { width:200px; height:250px; object-fit:cover; border:4px solid; border-image: linear-gradient(to right,#853605,#b14e05,#5b2b2a,#dc7b05,#853605) 1; flex-shrink:0; }
  .player-info { display:flex; flex-direction:column; gap:6px; font-weight:bold; color:#222; }

  .skill-row { display:flex; align-items:center; margin-bottom:10px; }
  .skill-name { flex:0 0 150px; font-size:1.3rem; font-weight:bold; color:#222; display:flex; align-items:center; }
  .skill-name img { width:24px; height:24px; margin-right:0.5rem; }
  .skill-boxes { flex:1; display:flex; justify-content:space-between; }
  .skill-box { width:25px; height:25px; background:#C97D1E; border:2px solid #AA6D2B; border-radius:4px; }
  .skill-red { background:#DD003B; border-color:#63003E; }
  .skill-yellow { background:#FFA400; border-color:#960027; }

  .title { color:#221122; }
  #inventory { margin:0; padding-left:1rem; font-size:20px; }
  #inventory li { margin:2px 0; padding:0; color:#221122; }

  .block-3, .block-4, .block-5 { min-height:100px; }
  #player-name { color:#221122; font-size:1.8rem; }
  #player-level { color:#221122; font-size:1.3rem; }
  #player-money img { vertical-align:text-bottom; width:20px; height:20px; }

  .stat-line { display:flex; align-items:center; gap:5px; font-size:1.1rem; }
  .stat-line img { width:20px; height:20px; }

  #notes-container { overflow-x:hidden; }
  #notes { display:flex; gap:10px; flex-wrap:nowrap; }
  .equip-square { display:flex; flex-direction:column; align-items:center; width:calc((100% - 30px)/4); border:2px solid #AA6D2B; border-radius:6px; padding:5px; background:#f5e6b3; flex-shrink:0; }
  .equip-square img { max-width:80%; height:auto; margin-bottom:5px; }
  .equip-name, .equip-effect { text-align:center; word-break:break-word; }
  .equip-name { font-weight:bold; color:#221122; }
  .equip-effect { font-size:0.9rem; color:#333; }

  /* --- Perícias --- */
  #skills-list {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    justify-content: center; /* centraliza */
    max-width: 600px;        /* largura máxima da grade */
    margin: 0 auto;          /* centraliza o bloco na tela */
  }


  .skill-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex: 0 1 120px;       /* largura base de 120px, mas pode encolher */
    max-width: 120px;      /* garante que não passe disso */
    padding: 10px;
    border: 2px solid #AA6D2B;
    border-radius: 6px;
    background: #f5e6b3;
  }

  .skill-card img {
    width: 64px;
    height: 64px;
    margin-bottom: 8px;
  }
  .skill-card span {
    font-size: 0.9rem;
    text-align: center;
    color: #221122;
    font-weight: bold;
  }

  @media(max-width:768px){
    .block-1 { flex-direction:column; align-items:center; }
    .profile-pic { width:150px; height:200px; }
    .player-info { align-items:center; }
    .skill-name { flex:0 0 120px; font-size:1.2rem; }
    .equip-square { width:calc((100% - 30px)/2); }
    .skill-card { flex: 0 1 calc((50% - 15px)); max-width: calc((50% - 15px)); }
  }

  #skills-list.empty {
    color: #221122; /* vermelho escuro */
    font-weight: bold;
    font-style: italic;
  }

  .content::-webkit-scrollbar { width:8px; }
  .content::-webkit-scrollbar-thumb { background:rgba(0,0,0,0.2); border-radius:6px; }
</style>
</head>
<body>

<div class="container">
  <div class="content">
    <div class="block block-1">
      <img id="player-pic" class="profile-pic" src="" alt="Foto do personagem">
      <div class="player-info">
        <div id="player-name">Nome</div>
        <div id="player-level">Nível</div>
        <div id="player-life" class="stat-line"><img src="pics/icons/vida.png" alt="Vida"> 0 / 0</div>
        <div id="player-energy" class="stat-line"><img src="pics/icons/energia.png" alt="Energia"> 0 / 0</div>
        <div id="player-money" class="stat-line"><img src="pics/icons/coin.png" alt="Moeda"> 0</div>
      </div>
    </div>
    <div class="divider"></div>
    <div class="block block-2" id="skills-container"></div>
    <div class="divider"></div>
    <div class="block block-3">
      <h2 class="title">Inventário</h2>
      <ul id="inventory"></ul>
    </div>
    <div class="divider"></div>
    <div class="block block-4">
      <div id="notes-container">
        <div id="notes"></div>
      </div>
    </div>
    <div class="divider"></div>
    <div class="block block-5">
      <h2 class="title">Perícias</h2>
      <div id="skills-list"></div>
    </div>
  </div>
</div>

<script>
const levelTitles = {
  0:"Principiante",1:"Principiante",2:"Principiante",3:"Novato",4:"Rústico",5:"Rústico",
  6:"Vaqueiro",7:"Vaqueiro",8:"Peão",9:"Peão",10:"Lavrador",11:"Lavrador",
  12:"Pequeno proprietário",13:"Pequeno proprietário",14:"Escavador",15:"Escavador",
  16:"Garoto(a) da Fazenda",17:"Garoto(a) da Fazenda",18:"Granjeiro",19:"Granjeiro",
  20:"Semeador",21:"Semeador",22:"Rancheiro",23:"Rancheiro",24:"Fazendeiro",25:"Fazendeiro",
  26:"Agricultor",27:"Agricultor",28:"Mestre de colheita",29:"Mestre de colheita",30:"Rei da Fazenda"
};

const loadPlayerDetails = async () => {
  const params = new URLSearchParams(window.location.search);
  const id = parseInt(params.get('id'),10);
  if(!id) return;

  const res = await fetch('data.json');
  const players = await res.json();
  const player = players.find(p=>p.ID===id);
  if(!player) return;

  document.getElementById("player-pic").src = player.Pic;
  document.getElementById("player-name").textContent = `${player.Nome}, ${player.Idade}`;
  document.getElementById("player-level").textContent = levelTitles[player.Level]||"Rei da Fazenda";
  document.getElementById("player-life").innerHTML = `<img src="pics/icons/vida.png" alt="Vida"> ${player.Vida} / ${player.Vida_max}`;
  document.getElementById("player-energy").innerHTML = `<img src="pics/icons/energia.png" alt="Energia"> ${player.Energia} / ${player.Energia_max}`;
  document.getElementById("player-money").innerHTML = `<img src="pics/icons/coin.png" alt="Moeda"> ${player.Dinheiro}`;

  // Habilidades (barra de progresso)
  const skillsContainer = document.getElementById("skills-container");
  const skillNames = ["Cultivo","Mineração","Coleta","Pesca","Combate"];
  const skillIcons = { "Cultivo":"pics/icons/cultivo.png","Mineração":"pics/icons/mineracao.png","Coleta":"pics/icons/coleta.png","Pesca":"pics/icons/pesca.png","Combate":"pics/icons/combate.png" };
  skillsContainer.innerHTML="";
  skillNames.forEach(skill=>{
    const skillRow=document.createElement("div"); skillRow.className="skill-row";
    const skillName=document.createElement("div"); skillName.className="skill-name";
    const icon=document.createElement("img"); icon.src=skillIcons[skill]; icon.alt=skill;
    skillName.appendChild(icon); skillName.appendChild(document.createTextNode(skill));
    const boxes=document.createElement("div"); boxes.className="skill-boxes";
    const level = player.Habilidades[skill]||0;
    for(let i=1;i<=10;i++){ 
      const box=document.createElement("div"); 
      box.className="skill-box"; 
      if(i<=level) box.classList.add(i%5===0?"skill-yellow":"skill-red"); 
      boxes.appendChild(box);
    }
    skillRow.appendChild(skillName); skillRow.appendChild(boxes); 
    skillsContainer.appendChild(skillRow);
  });

  // Inventário
  const inv = document.getElementById("inventory"); inv.innerHTML="";
  player.Inventario.forEach(obj=>{ 
    const li=document.createElement("li"); 
    li.textContent=`${obj.Quantidade}x ${obj.Item}`; 
    inv.appendChild(li); 
  });

  // Perícias
  const skillsRes = await fetch('Pericias.json');
  const skillsData = await skillsRes.json();
  const skillsList = document.getElementById("skills-list");
  skillsList.innerHTML="";
  if (player.Skills && player.Skills.length > 0) {
    player.Skills.forEach(skillId => {
      const skillData = skillsData.find(s => s.Id === skillId);
      if (skillData) {
        const card = document.createElement("div");
        card.className = "skill-card";
        const img = document.createElement("img");
        img.src = skillData.Pic;
        img.alt = skillData.Nome;
        const name = document.createElement("span");
        name.textContent = skillData.Nome;
        card.appendChild(img);
        card.appendChild(name);
        skillsList.appendChild(card);
      }
    });
  } else {
    skillsList.textContent = "Nenhuma perícia aprendida.";
    skillsList.classList.add("empty");
  }

  // Equipamentos
  const [shoesRes,ringsRes,weaponsRes] = await Promise.all([fetch('shoes.json'),fetch('rings.json'),fetch('weapons.json')]);
  const [shoes,rings,weapons] = await Promise.all([shoesRes.json(),ringsRes.json(),weaponsRes.json()]);

  const equipIds = [
    { id: player.Arma, type: 'weapon' },
    { id: player.Bota, type: 'shoe' },
    { id: player.Anel_1, type: 'ring' },
    { id: player.Anel_2, type: 'ring' }
  ];

  const notesDiv = document.getElementById("notes");
  notesDiv.innerHTML="";

  equipIds.forEach(eq=>{
    const div=document.createElement("div"); div.className="equip-square";
    let itemData;
    if(eq.type==='shoe') itemData=shoes.find(s=>s.id===eq.id);
    else if(eq.type==='ring') itemData=rings.find(r=>r.id===eq.id);
    else if(eq.type==='weapon') itemData=weapons.find(w=>w.id===eq.id);
    if(itemData){
      const img=document.createElement("img"); img.src=itemData.icon; img.alt=itemData.nome;
      const name=document.createElement("div"); name.className="equip-name"; name.textContent=itemData.nome;
      const effect=document.createElement("div"); effect.className="equip-effect"; effect.textContent=eq.type==='weapon'?itemData.dano:itemData.efeito;
      div.appendChild(img); div.appendChild(name); div.appendChild(effect);
    }
    notesDiv.appendChild(div);
  });
};

loadPlayerDetails();
</script>

</body>
</html>
